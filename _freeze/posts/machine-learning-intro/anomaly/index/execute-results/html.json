{
  "hash": "6d92b03c30d482c0aab2c4d54c62275a",
  "result": {
    "markdown": "---\ntitle: 'Anomaly/Outlier Detection'\ndate: '2023-11-20'\ncategories: ['code']\ndescription: 'Unveiling Anomalies with Outlier Detection in Machine Learning'\nexecute: \n  message: false\n  warning: false\neditor_options: \n  chunk_output_type: console\n---\n\n## Introduction\n\nAnomaly detection, a critical aspect of machine learning, involves identifying patterns in data that deviate significantly from the norm. This technique finds applications in various domains, from fraud detection in financial transactions to detecting anomalies in network traffic for cybersecurity.\n\n### Challenges of Anomaly Detection\n\nWhile anomaly detection is a powerful tool, it comes with challenges. Real-world data often exhibits diverse distributions, and datasets can be imbalanced, making it tricky to identify rare anomalies accurately. Robust algorithms are essential to overcome these challenges.\n\n## Data Visualization\n\nI use the following colors in all of my blogs data visualizations\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\n# Define specific colors (same as CSS from quarto vapor theme)\nbackground = '#1b133a'\npink = '#ea39b8'\npurple = '#6f42c1'\nblue = '#32fbe2'\n```\n:::\n\n\n### **DBSCAN and Evaluation Metrics for Anomaly Detection**\n\nDensity-Based Spatial Clustering of Applications with Noise (DBSCAN) emerges as a robust algorithm for anomaly detection. Unlike traditional methods, DBSCAN doesn't assume a specific shape for clusters and can effectively isolate points in low-density regions as outliers.\n\nVisualizing anomalies is crucial for interpreting model results. Scatter plots with DBSCAN labels provide an intuitive representation of the identified anomalies in the dataset.\n\nEvaluating anomaly detection models poses challenges due to the scarcity of anomalies. Metrics such as precision, recall, and F1 score provide a nuanced understanding of the model's performance.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nfrom sklearn.metrics import precision_score, recall_score, f1_score\nfrom sklearn.cluster import DBSCAN\nfrom sklearn.datasets import make_blobs\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Function to generate a synthetic dataset with outliers\ndef generate_dataset_with_outliers(seed=42):\n    np.random.seed(seed)\n    X, _ = make_blobs(n_samples=300, centers=1, cluster_std=1, random_state=0)\n    outliers = np.random.uniform(low=-10, high=10, size=(20, 2))\n    return np.concatenate([X, outliers]), np.concatenate([np.zeros(300), -np.ones(20)])\n\n# Step 1: Generate a synthetic dataset with outliers\nX, y_true = generate_dataset_with_outliers()\n\n# Step 2: Train a DBSCAN model for anomaly detection\ndbscan = DBSCAN(eps=1, min_samples=5)\npredicted_labels = dbscan.fit_predict(X)\n\n# Step 3: Visualize anomalies with DBSCAN labels\nfig, ax = plt.subplots()\nscatter = ax.scatter(X[:, 0], X[:, 1], c=predicted_labels, cmap=plt.cm.cool, edgecolor='black', s=50)\nax.set_title('Anomaly Detection with DBSCAN', color=purple)\nax.set_xlabel('Feature 1', color=blue)\nax.set_ylabel('Feature 2', color=blue)\nax.grid(True, linestyle='--', alpha=0.5)\nax.tick_params(axis='x', colors=blue)\nax.tick_params(axis='y', colors=blue)\nax.set_facecolor(pink)\nfig.set_facecolor(background)\nplt.show()\n\n# Step 4: Evaluate the model using precision, recall, and F1 score\nprecision = precision_score(y_true, predicted_labels, pos_label=-1)\nrecall = recall_score(y_true, predicted_labels, pos_label=-1)\nf1 = f1_score(y_true, predicted_labels, pos_label=-1)\n\nprint(f\"Precision: {precision:.2f}\")\nprint(f\"Recall: {recall:.2f}\")\nprint(f\"F1 Score: {f1:.2f}\")\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-1.png){width=608 height=449}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nPrecision: 1.00\nRecall: 0.90\nF1 Score: 0.95\n```\n:::\n:::\n\n\nAnomaly detection, powered by algorithms like DBSCAN, plays a vital role in uncovering irregularities in data. The combination of effective visualizations and evaluation metrics enables us to gain insights into the anomalies present, providing a foundation for critical decision-making in various domains.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}